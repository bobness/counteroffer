<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
    
    <link rel="stylesheet" href="style.css" />
    <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon" />
    <link href="bower_components/angular-xeditable/dist/css/xeditable.css" rel="stylesheet">
    
    <title>Counteroffer</title>
    
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <script src="bower_components/angular/angular.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script src="bower_components/angular-xeditable/dist/js/xeditable.min.js"></script>
    <script src="app.js"></script>
    
  </head>
  
  <body ng-app="counteroffer.app" ng-controller="controller">
    
    <!--
      use cases:
        - track jobs - for 1 core counteroffer
          x - add jobs to db from co.me
          x - view jobs on co.app
          x - fix bootstrap issue where > 1 card can be open at one time
          x - improve styling for job cards so it's obvious you're looking at one of them (i.e., make it look more like an accordion)
          x - make another table called 'messages' to differentiate from 'facts', and put initial question values in it
          x - implement selection-based fact-adding (take code from portfolio-creator) and add it to the 'scratch pad' for the selected job by adding it to the 'facts' table
          - move to counteroffer.me/production and make sure it works (start with port = 3000, and then reconfig upstart to run all 3 node services, then move to port 80)
          - re-add emailing myself when I get a new contact, w/ a link to the job (involves parsing the path or hash for the job ID and selecting that job)
        
        - respond to recruiter (i.e., add message to job 'message') - for 1 core counteroffer
          - add datetime to message entries if not already there
          - show a read-only version of their survey response after submitting it - the start of a discussion
          - implement 'remember me' checkbox on the survey (w/ cookie)
          - implement another checkbox to notify them of responses via email (or maybe combine w/ prev checkbox)
        
        - publish multiple counteroffers to counteroffer.me
          - merge portfolio-creator (via npm install) onto this interface (I think?)
          - create another table 'counteroffers' and link to 'jobs'
        
        - list jobs/discussions per counteroffer
          - consider adding a tab UI to co.app to show them
    -->
    <h1 style="text-align:center;">Counteroffer</h1>
    <div class="col-lg-12" style="margin: 0 auto;text-align:center;">
      <div class="col-sm-8" id="accordion" style="margin-top:15px;">
        <div ng-repeat="job in jobs track by $index" ng-show="!busy" class="panel panel-default">
          <div class="panel-heading" id="heading{{$index+1}}" data-toggle="collapse" data-target="#collapse{{$index+1}}" aria-expanded="false" aria-controls="collapse${$index+1}}" style="cursor:pointer;" ng-click="toggleJob(job)">
            Job #{{ $index + 1 }} from {{ job.email }}
          </div>
      
          <div id="collapse{{$index+1}}" class="collapse" aria-labelledby="heading{{$index+1}}" data-parent="#accordion">
            <div ng-show="gettingMessages">
              <img src="loading.gif" />
            </div>
            <div class="panel-body" ng-hide="gettingMessages">
              <ul style="text-align:left;">
                <li ng-repeat="message in job.messages"><strong>{{ message.text }}</strong> - {{ message.value }}</li>
              </ul>
            </div>
          </div>
          
        </div>
        <div ng-show="busy">
          <img src="loading.gif" />
        </div>
      </div>
      
      <div class="col-sm-4">
        <div class="panel panel-default" id="scratchPad">
          <div class="panel-heading">Scratch Pad</div>
          <div class="panel-body">
            <div ng-show="gettingFacts">
              <img src="loading.gif" />
            </div>
            <ul style="text-align:left;">
              <li ng-repeat="fact in selectedJob.facts | orderBy: 'id'" ng-hide="gettingFacts">
                #{{ fact.id }}
                <a href="#" editable-text="fact.key" onaftersave="updateFact(selectedJob, fact)">
                  <strong>{{ fact.key }}</strong>
                </a> &rarr;
                <a href="#" editable-text="fact.value" onaftersave="updateFact(selectedJob, fact)">
                  {{ fact.value }}
                </a>
              </li>
            </ul>
            <div ng-show="!selectedJob.facts || selectedJob.facts.length === 0">
              <p>Select text from the job messages to add facts to your scratch pad</p>
            </div>
            <div style="margin-top:15px;" ng-show="selectedJob">
              <button class="btn btn-sm btn-default" ng-click="addFactFromSelection(selectedJob)">
                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                Add Selected Text
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    
  </body>
</html>